<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<title>UrFastR.tv player (beta)</title>
	<meta name="description" content="UrFastR video player for live and prerecorded video">
	<meta name="keywords" content="video, web2.0, p2p, stream, live, player">
<script src="../../base/firebug/firebug.js"></script> 
<script src="../../base/javascript/neoip_core.js"></script>
<script src="../../base/javascript/neoip_objembed_initmon_t.js"></script>
<script src="../../base/javascript/neoip_base64_safe.js"></script>
<script src="../../base/javascript/neoip_nested_uri_builder_t.js"></script> 
<script src="../../base/javascript/swfobject.js"></script>
<script src="../../base/javascript/neoip_xdomrpc_t.js"></script>
<script src="../../base/javascript/neoip_apps_detect_t.js"></script> 
<script src="../../base/javascript/neoip_apps_detect_wikidbg_t.js"></script> 
<script src="../../base/javascript/neoip_webpack_detect_t.js"></script> 
<script src="../../base/javascript/neoip_wikidbg_t.js"></script>
<script src="../../base/javascript/neoip_casti_ctrl_t.js"></script> 
<script src="../../player/jsplayer/neoip_playlist_t.js"></script>
<script src="../../player/jsplayer/neoip_playlist_track_t.js"></script>
<script src="../../player/jsplayer/neoip_playlist_loader_t.js"></script>
<script src="../../player/jsplayer/neoip_plistarr_t.js"></script>
<script src="../../player/jsplayer/neoip_plistarr_item_t.js"></script>
<script src="../../player/jsplayer/neoip_plistarr_loader_t.js"></script>
<script src="../../player/jsplayer/neoip_subplayer_cb_t.js"></script>
<script src="../../player/jsplayer/neoip_subplayer_vlc_t.js"></script>
<script src="../../player/jsplayer/neoip_subplayer_asplayer_t.js"></script>
<script src="../../player/jsplayer/neoip_player_t.js"></script>
<script src="../../player/jsplayer/neoip_player_wikidbg_t.js"></script>
<script src="../../player/jsplayer/neoip_recorder_t.js"></script>
<script src="../../player/jsplayer/neoip_prefetcher_t.js"></script>
<script src="../../player/jsplayer/neoip_ezplayer_t.js"></script>
<script src="../../player/jsplayer/neoip_ezplayer_embedui_t.js"></script>
<style type="text/css">	
	/* body style for the video fullpage mode - hardcoded for now */
	html, body {
		height	: 100%;
		width	: 100%;
		margin	: 0px;
		overflow: hidden;
		background-color: transparent;
	}
</style>

<body>

<div id="neoip_player_container_id">Place to put player container</div>


<!-- <center><h3>NeoIP web player demo</h3></center>
<table cellpadding="0px" cellspacing="0px">
<tr><td>
	<div id="neoip_player_container_id">Place to put player container</div>
</td><td><table><tr><td >
	<div id="player_info_container_id"></div>
</td></tr><tr><td>
	<div id="apps_detect_container_id"></div>
</td></tr></table>
</table>
<div id="debug_info_container_id"></div>
-->



</script>
<script>
//	var cast_name		= "LCP an"
//	var cast_privhash	= "e334e91c";
	var cast_name		= "";
	var cast_privhash	= "";

	// extract all configuration options from the document URI
	// - this is ok as it is suppposed to be used as iframe
	var urivar_arr	= neoip.core.doc_urivar_arr();
	var cfgvar_arr	= {
		//'onload_start_play'	: "enabled",
		//'fullpage_state'	: 'maximized'
	};		
	for(var key in urivar_arr){
		// goto the next if not prefixed by "neoip_var_"
		if( /^neoip_var_/.test(key) == false )	continue;
		// remove the prefix from the key
		stripped_key	= /^neoip_var_(.*)/.exec(key)[1]
		// copy the value in cfgvar_arr
		cfgvar_arr[stripped_key]	= urivar_arr[key];
	}
	
	console.dir(cfgvar_arr);

	// build the neoip.ezplayer_t
	var ezplayer	= new neoip.ezplayer_t(cfgvar_arr);
	// commented out - been replace by a more generic cfgvar_arr, settable from url var
	//	ezplayer.play_post_playlist(true);
	//	ezplayer.fullpage_state("maximized");	
	// set the server_date in ezplayer
	ezplayer.set_server_date( parseFloat(neoip.core.download_file_insync("../../cgi-bin/server_date.php", true))*1000 );

	// if the uri contains a cast_name and cast_privhash variable, use it to load this playlist
	// - additionnaly dont put a playlist_arr, so impossible to change channel
	if( cast_name != "" && cast_privhash != "" ){
		// set the playlist_url in the ezplayer_t
		var	playlist_url	= "../../cgi-bin/cast_get_playlist.fcgi?basename="+ cast_name +"_"+cast_privhash+".playlist_jspf";
		ezplayer.change_playlist(playlist_url);
	}else{
		var plistarr_url	= "../mdata_echo_server/data/ezplayer_playlist_arr.json";
		//var plistarr_url	= "testrpc.php/castiRecordWebSrv/GetPlistArr";
		ezplayer.load_plistarr(plistarr_url);
	}
	// start the ezplayer_t
	ezplayer.start();
</script>

<!-- ************************************************************ -->
<!-- ************************************************************ -->
<!-- *		handle a API with crossframe library 		* -->
<!-- ************************************************************ -->
<!-- ************************************************************ -->
<!--
-->
<script src="../../lib/crossframe/crossframe_rpc_server.standalone-min.js"></script>
<script>
var rpc_server	= crossframe.rpc_server_t({
	listener_obj:	"crossframe_msg"
});
rpc_server.register("playing_start", function(){
	console.info("rpc_server playing start");
	ezplayer.playing_start();
});
rpc_server.register("playing_stop", function(){
	console.info("rpc_server playing stop");
	ezplayer.playing_stop();
});
</script>

</body>
</html>
